{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 15,
  "summary": "Build a mobile-friendly DApp/dashboard for a Binance Smart Chain (BSC) multi-token vault smart contract, allowing wallet connection and vault interactions (view balances, deposit/withdraw tokens and BNB) using the provided contract address and ABI.",
  "architectural_notes": [
    "Target Binance Smart Chain and interact with the deployed vault contract via its ABI.",
    "Design UI to be mobile-first and handle missing injected provider (window.ethereum) gracefully (e.g., show instructions to open in MetaMask).",
    "Reuse the existing watched-token list as the source for a token dropdown in Deposit/Withdraw; fetch and cache token metadata (at least symbol/name/decimals) for display.",
    "Add optional price-quote integration to compute and display balance values in USDT/BNB (e.g., via on-chain DEX quote or external price API), with clear handling when pricing is unavailable.",
    "Consider adding WalletConnect (or equivalent) to support non-injected mobile wallets (SafePal/Trust/TokenPocket, etc.) in addition to MetaMask."
  ],
  "known_issues": [
    "Draft/preview build is not working (user reports it does not load/work on device).",
    "Balances are not fetching/displaying correctly (vault BNB and/or token balances not loading).",
    "Adding a token by contract address is not working (watch list / token balance lookup by address fails).",
    "Balance reads are reverting with `execution reverted: 0x`, causing BNB and token balances to not display.",
    "BNB balance is not showing in some UI states (e.g., when opening Deposit/Withdraw).",
    "Deposit/Withdraw token contract dropdown UI overlaps the amount input due to transparency/stacking, reducing readability."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-ensure-the-dapp-connects-to-and-interacts-with-the-binance-smart-chain-vault-contract-at-address-0xd2e7da1e8e2cda1512a5cc9d1c477d95599f0ec4-using-the-provided-abi-methods-bnbbalance-tokenbalance-address-deposittoken-address-uint256-withdrawbnb-address-uint256-and-withdrawtoken-address-address-uint256",
      "title": "Ensure the dApp connects to and interacts with the Binance Smart Chain vault contract at address `0xd2e7DA1e8E2cda1512A5CC9d1C477D95599f0eC4` using the provided ABI methods: `bnbBalance()`, `tokenBalance(address)`, `depositToken(address,uint256)`, `withdrawBNB(address,uint256)`, and `withdrawToken(address,address,uint256)`.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-contract-call-encoding-decoding-and-numeric-handling-to-be-safe-for-large-uint256-values-use-bigint-for-parsing-rpc-hex-results-and-for-converting-user-entered-amounts-to-wei-and-ensure-abi-encoding-correctly-handles-address-and-uint256-parameters-without-relying-on-parseint-or-double-padding",
      "title": "Fix contract call encoding/decoding and numeric handling to be safe for large `uint256` values: use `BigInt` for parsing RPC hex results and for converting user-entered amounts to wei, and ensure ABI encoding correctly handles `address` and `uint256` parameters without relying on `parseInt` or double-padding.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-a-working-watch-list-for-token-balances-when-a-user-adds-a-bep20-token-address-in-the-balances-tab-persist-it-in-state-and-refetch-to-show-that-token-s-tokenbalance-address-include-the-ability-to-remove-a-watched-token-persist-the-watch-list-locally-e-g-localstorage-so-it-survives-page-refresh",
      "title": "Implement a working “watch list” for token balances: when a user adds a BEP20 token address in the Balances tab, persist it in state and refetch to show that token’s `tokenBalance(address)`; include the ability to remove a watched token; persist the watch list locally (e.g., localStorage) so it survives page refresh.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-mobile-wallet-compatibility-and-fallback-ux-if-no-injected-provider-is-detected-no-window-ethereum-show-mobile-specific-guidance-to-open-the-dapp-in-the-metamask-mobile-in-app-browser-and-keep-the-existing-install-link-if-a-provider-exists-but-the-chain-is-not-bsc-provide-a-clear-actionable-prompt-and-keep-one-tap-network-switching-to-bsc",
      "title": "Improve mobile wallet compatibility and fallback UX: if no injected provider is detected (no `window.ethereum`), show mobile-specific guidance to open the dApp in the MetaMask mobile in-app browser (and keep the existing install link). If a provider exists but the chain is not BSC, provide a clear, actionable prompt and keep one-tap network switching to BSC.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-make-the-web3-layer-internally-consistent-by-implementing-callcontract-and-sendtransaction-in-useweb3-currently-placeholders-and-refactor-vault-reads-writes-to-use-those-functions-instead-of-duplicating-direct-window-ethereum-request-logic-in-multiple-hooks",
      "title": "Make the Web3 layer internally consistent by implementing `callContract` and `sendTransaction` in `useWeb3` (currently placeholders) and refactor vault reads/writes to use those functions (instead of duplicating direct `window.ethereum.request` logic in multiple hooks).",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-a-coherent-visual-theme-optimized-for-mobile-readability-and-touch-targets-across-the-dashboard-colors-typography-spacing-and-enforce-it-consistently-across-header-wallet-connect-tabs-and-forms-avoid-a-blue-purple-primary-palette",
      "title": "Apply a coherent visual theme optimized for mobile readability and touch targets across the dashboard (colors, typography, spacing) and enforce it consistently across Header, wallet connect, tabs, and forms. Avoid a blue/purple primary palette.",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-app-renders-without-crashing-by-wrapping-the-react-app-in-the-existing-web3provider-so-that-all-components-using-useweb3-e-g-dashboard-walletconnect-have-the-required-context",
      "title": "Ensure the app renders without crashing by wrapping the React app in the existing `Web3Provider` so that all components using `useWeb3()` (e.g., `Dashboard`, `WalletConnect`) have the required context.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-user-visible-error-fallback-for-unexpected-runtime-exceptions-e-g-missing-providers-or-other-uncaught-errors-so-the-preview-shows-a-readable-english-error-message-and-a-clear-recovery-action-e-g-reload-instead-of-failing-silently",
      "title": "Add a user-visible error fallback for unexpected runtime exceptions (e.g., missing providers or other uncaught errors) so the preview shows a readable English error message and a clear recovery action (e.g., reload) instead of failing silently.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-add-token-to-watch-flow-so-that-entering-a-bep20-token-contract-address-reliably-adds-it-to-the-watched-token-list-using-strict-evm-address-validation-normalization-and-clear-english-error-messages-for-invalid-input",
      "title": "Fix the “Add Token to Watch” flow so that entering a BEP20 token contract address reliably adds it to the watched token list, using strict EVM address validation/normalization and clear English error messages for invalid input.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-vault-balance-fetching-so-bnb-balance-and-watched-token-balances-reliably-load-and-update-and-provide-user-visible-english-error-feedback-when-reads-fail-instead-of-only-logging-to-console",
      "title": "Fix vault balance fetching so BNB balance and watched token balances reliably load and update, and provide user-visible, English error feedback when reads fail (instead of only logging to console).",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-balances-tab-token-list-ui-remains-consistent-with-the-watched-token-list-even-when-some-token-balance-calls-fail-e-g-show-watched-tokens-with-a-per-token-error-unknown-balance-state-rather-than-silently-dropping-them-from-the-ui",
      "title": "Ensure the Balances tab token list UI remains consistent with the watched token list even when some token balance calls fail (e.g., show watched tokens with a per-token error/unknown balance state rather than silently dropping them from the UI).",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-persistent-saved-tokens-catalog-so-that-when-a-user-adds-a-bep20-token-address-once-the-app-can-later-display-that-token-as-a-selectable-option-showing-a-human-friendly-token-name-label-instead-of-requiring-the-user-to-paste-the-token-contract-address-every-time",
      "title": "Add a persistent “saved tokens” catalog so that when a user adds a BEP20 token address once, the app can later display that token as a selectable option (showing a human-friendly token name/label) instead of requiring the user to paste the token contract address every time.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-add-token-to-watch-ui-balances-tab-to-optionally-capture-and-persist-a-token-label-name-alongside-the-token-contract-address-and-keep-existing-strict-address-validation-normalization-behavior-for-the-address-field",
      "title": "Update the “Add Token to Watch” UI (Balances tab) to optionally capture and persist a token label/name alongside the token contract address, and keep existing strict address validation/normalization behavior for the address field.",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-the-free-text-token-contract-address-input-in-the-deposit-form-with-a-token-selector-that-lets-the-user-choose-from-previously-added-watched-tokens-show-token-label-name-in-the-dropdown-while-still-allowing-manual-entry-paste-as-a-fallback-for-tokens-not-yet-saved",
      "title": "Replace the free-text “Token Contract Address” input in the Deposit form with a token selector that lets the user choose from previously added/watched tokens (show token label/name in the dropdown), while still allowing manual entry/paste as a fallback for tokens not yet saved.",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-the-free-text-token-contract-address-input-in-the-withdraw-token-tab-with-a-token-selector-that-lets-the-user-choose-from-previously-added-watched-tokens-show-token-label-name-in-the-dropdown-while-still-allowing-manual-entry-paste-as-a-fallback",
      "title": "Replace the free-text “Token Contract Address” input in the Withdraw Token tab with a token selector that lets the user choose from previously added/watched tokens (show token label/name in the dropdown), while still allowing manual entry/paste as a fallback.",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-balance-reads-that-currently-fail-with-execution-reverted-0x-so-the-balances-tab-reliably-shows-the-vault-s-bnbbalance-and-watched-token-tokenbalance-address-values-on-bsc",
      "title": "Fix balance reads that currently fail with `execution reverted: 0x` so the Balances tab reliably shows the vault’s `bnbBalance()` and watched-token `tokenBalance(address)` values on BSC.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-a-read-only-rpc-fallback-for-contract-reads-so-vault-balances-can-still-be-fetched-even-when-metamask-eth-call-fails-by-calling-a-bsc-json-rpc-endpoint-directly-for-eth-call-read-operations-only",
      "title": "Implement a read-only RPC fallback for contract reads so vault balances can still be fetched even when MetaMask `eth_call` fails, by calling a BSC JSON-RPC endpoint directly for `eth_call` (read operations only).",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-add-valuation-display-for-balances-if-the-vault-has-a-bnb-balance-show-the-bnb-amount-and-its-value-in-usdt-for-each-watched-token-show-token-quantity-and-its-approximate-value-in-usdt-and-or-bnb-when-a-price-is-available",
      "title": "Add valuation display for balances: if the vault has a BNB balance, show the BNB amount and its value in USDT; for each watched token, show token quantity and its approximate value in USDT and/or BNB when a price is available.",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-dashboard-page-so-the-user-can-view-vault-balances-in-a-read-only-mode-even-when-a-wallet-is-not-connected-i-e-do-not-hide-the-balances-tab-and-balanceview-behind-isconnected-deposit-withdraw-actions-must-remain-gated-behind-a-connected-wallet-on-bsc-but-balances-should-still-be-visible-using-the-existing-eth-call-rpc-fallback",
      "title": "Update the Dashboard page so the user can view vault balances in a read-only mode even when a wallet is not connected (i.e., do not hide the Balances tab and BalanceView behind `isConnected`). Deposit/Withdraw actions must remain gated behind a connected wallet on BSC, but balances should still be visible using the existing `eth_call` + RPC fallback.",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-add-clear-user-facing-status-messaging-in-the-balances-ui-for-the-disconnected-read-only-state-and-for-balance-fetch-failures-so-users-understand-why-they-may-not-see-balances-e-g-rpc-not-reachable-contract-call-reverted",
      "title": "Add clear user-facing status messaging in the balances UI for the disconnected/read-only state and for balance fetch failures, so users understand why they may not see balances (e.g., RPC not reachable, contract call reverted).",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-vault-bnb-balance-is-visible-and-updates-correctly-even-when-the-user-switches-to-the-deposit-or-withdraw-tabs-i-e-do-not-rely-on-the-balances-tab-being-mounted-for-the-bnb-balance-to-be-shown",
      "title": "Ensure the vault BNB balance is visible and updates correctly even when the user switches to the Deposit or Withdraw tabs (i.e., do not rely on the Balances tab being mounted for the BNB balance to be shown).",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-token-contract-address-dropdown-token-selector-styling-so-that-when-the-dropdown-is-opened-it-does-not-visually-overlap-blend-with-the-amount-input-the-dropdown-must-be-fully-opaque-with-proper-layering-and-readable-contrast",
      "title": "Fix the Token Contract Address dropdown (token selector) styling so that when the dropdown is opened it does not visually overlap/blend with the Amount input; the dropdown must be fully opaque with proper layering and readable contrast.",
      "reqIds": [
        "REQ-22"
      ],
      "version": 1
    },
    {
      "id": "feature-update-wallet-connectivity-and-ux-copy-to-support-and-describe-connecting-via-any-injected-eip-1193-wallet-provider-e-g-metamask-trust-wallet-safepal-tokenpocket-instead-of-metamask-only-wording-connection-logic-must-work-with-window-ethereum-from-these-wallets-in-app-browsers-extension-providers",
      "title": "Update wallet connectivity and UX copy to support and describe connecting via any injected EIP-1193 wallet provider (e.g., MetaMask, Trust Wallet, SafePal, TokenPocket) instead of MetaMask-only wording; connection logic must work with `window.ethereum` from these wallets’ in-app browsers/extension providers.",
      "reqIds": [
        "REQ-23"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Mobile-friendly BSC vault dashboard DApp that connects to the existing vault contract (0xd2e7DA1e8E2cda1512A5CC9d1C477D95599f0eC4) using the provided ABI",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Wallet connection flow for mobile (MetaMask mobile/in-app browser compatibility; optional WalletConnect) with clear fallback UI when no provider is available",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Read-only vault views: display vault BNB balance (bnbBalance) and token balance lookup (tokenBalance(token))",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Write interactions: depositToken(token, amount), withdrawBNB(to, amount), withdrawToken(token, to, amount) via connected wallet",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Add a saved token list and token selector dropdown for deposit/withdraw so users can pick a previously added token (show token name/symbol) instead of pasting the token contract address each time",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Show balances with valuation: if BNB balance exists, display BNB amount plus value in USDT; if token balances exist, display token quantity plus value in BNB or USDT",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Add broad wallet compatibility (e.g., WalletConnect) so the DApp can connect with wallets like SafePal, Trust Wallet, MetaMask, TokenPocket, etc.",
      "reqIds": [],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Binance Smart Chain Vault Dashboard",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}